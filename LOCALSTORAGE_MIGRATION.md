# Миграция на LocalStorage

## Обзор изменений

Данные избранного и корзины покупок теперь хранятся в LocalStorage браузера вместо серверного API.

## Измененные файлы

### 1. favorites.js

- **Удалено**: API вызовы к `http://localhost:3001/favorites`
- **Добавлено**: Функции для работы с LocalStorage
  - `getFavoritesFromStorage()` - получение избранного из LocalStorage
  - `saveFavoritesToStorage()` - сохранение избранного в LocalStorage
- **Изменено**: Все функции теперь работают синхронно с LocalStorage

### 2. cart.js

- **Удалено**: API вызовы к `http://localhost:3001/cart` и `http://localhost:3001/orders`
- **Добавлено**: Функции для работы с LocalStorage
  - `getCartFromStorage()` - получение корзины из LocalStorage
  - `saveCartToStorage()` - сохранение корзины в LocalStorage
  - `getOrdersFromStorage()` - получение заказов из LocalStorage
  - `saveOrdersToStorage()` - сохранение заказов в LocalStorage
- **Изменено**: Все функции теперь работают синхронно с LocalStorage

### 3. catalog.js

- **Удалено**: API вызовы для добавления в избранное и корзину
- **Добавлено**: Функции для работы с LocalStorage (аналогично favorites.js и cart.js)
- **Изменено**: Обработчики кликов теперь сохраняют данные в LocalStorage

## Структура данных в LocalStorage

### Избранное (`favorites`)

```javascript
[
  {
    id: 'уникальный_идентификатор',
    userId: 'идентификатор_пользователя',
    productId: 'идентификатор_товара',
    title: 'Название товара',
    price: 100,
    image: 'путь_к_изображению',
    addedAt: '2025-01-20T10:00:00.000Z',
  },
];
```

### Корзина (`cart`)

```javascript
[
  {
    id: 'уникальный_идентификатор',
    userId: 'идентификатор_пользователя',
    productId: 'идентификатор_товара',
    title: 'Название товара',
    price: 100,
    image: 'путь_к_изображению',
    quantity: 2,
    addedAt: '2025-01-20T10:00:00.000Z',
  },
];
```

### Заказы (`orders`)

```javascript
[
  {
    id: "уникальный_идентификатор",
    userId: "идентификатор_пользователя",
    userName: "Имя пользователя",
    userEmail: "email@example.com",
    date: "2025-01-20T10:00:00.000Z",
    items: [...], // массив товаров
    total: 200,
    status: "pending"
  }
]
```

## Тестирование

### 1. test-localStorage.html

Интерактивная страница для тестирования функциональности LocalStorage:

- Установка тестового пользователя
- Добавление/удаление товаров в избранное
- Добавление/удаление товаров в корзину
- Очистка всех данных

### 2. migrate-to-localStorage.html

Утилита для миграции существующих данных из db.json в LocalStorage:

- Загрузка данных из db.json
- Автоматическая миграция в LocalStorage
- Просмотр мигрированных данных

## Преимущества

1. **Производительность**: Нет задержек на сетевые запросы
2. **Офлайн работа**: Данные доступны без интернета
3. **Простота**: Не требуется сервер для хранения данных пользователя
4. **Безопасность**: Данные хранятся локально в браузере пользователя

## Ограничения

1. **Локальность**: Данные доступны только в текущем браузере
2. **Размер**: LocalStorage имеет ограничение ~5-10MB
3. **Синхронизация**: Данные не синхронизируются между устройствами

## Совместимость

Все изменения обратно совместимы. Если в LocalStorage нет данных, приложение работает как обычно, но с пустыми списками избранного и корзины.

## Миграция существующих данных

Если у вас есть данные в db.json, которые нужно перенести в LocalStorage:

1. Откройте `migrate-to-localStorage.html`
2. Скопируйте содержимое db.json в текстовое поле
3. Нажмите "Мигрировать данные"
4. Проверьте результат в разделе "Текущие данные в LocalStorage"
